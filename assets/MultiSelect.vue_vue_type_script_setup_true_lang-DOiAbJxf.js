import{i as k,b as z,c as T}from"./array-ChzTB90U.js";import{f as x,_ as L}from"./SearchResultSpan.vue_vue_type_script_setup_true_lang-DLEqZUCl.js";import{d as y,e as v,y as q,o as p,c as m,b as f,t as N,a as b,u as $,_ as U,n as w,I as V,g as _,f as C,w as S,r as B,F as I,h as E,af as M,x as F,z as W}from"./app-BJS3HRcf.js";import{_ as j}from"./FlexibleMenu.vue_vue_type_script_setup_true_lang-CXpDXAmR.js";import{_ as A}from"./BaseSimpleSelect.vue_vue_type_script_setup_true_lang-jRGyN6s5.js";const G={class:w(["group cursor-pointer rounded bg-grey-5","flex flex-nowrap items-center","px-4 py-1 hover:pr-0"])},H={class:"grow overflow-hidden text-ellipsis whitespace-nowrap"},P=y({name:"MultiSelectChip"}),R=y({...P,props:{selectedOption:{},container:{}},emits:["delete:selectedOption"],setup(h,{expose:O,emit:t}){const u=h,a=t,l=v();return q([l,()=>u.selectedOption],()=>{var n;if(l.value){const r=(n=u.container)==null?void 0:n.getBoundingClientRect().width,e=l.value.getBoundingClientRect().width;l.value.style.width=`${Math.min(r??e,e)}px`,l.value.style.minWidth=`${Math.min(r??e,e)}px`}}),O({chip:l}),(n,r)=>(p(),m("div",{ref_key:"chip",ref:l,onClick:r[0]||(r[0]=()=>a("delete:selectedOption"))},[f("div",G,[f("div",H,N(n.selectedOption.title),1),b(U,{icon:$(V).IconCross,size:16,class:"mx-2 hidden shrink-0 text-blueGrey-2 group-hover:block"},null,8,["icon"])])],512))}}),J=y({name:"MultiSelectChips"}),K=y({...J,props:{selectedOptions:{},disabled:{type:Boolean},container:{}},emits:["delete:selectedOption"],setup(h,{emit:O}){const t=h,u=O,a=v(!1),l=v(),n=v([...t.selectedOptions]),r=v([]),e=_(()=>{var i;return t.selectedOptions.length-Number((i=l.value)==null?void 0:i.indexOfNotFitItem)});return q(()=>t.selectedOptions,()=>{var i;return(i=l.value)==null?void 0:i.rerender([...t.selectedOptions])}),(i,s)=>(p(),C(j,{ref_key:"flexibleTab",ref:l,"visible-items":n.value,"collapsed-items":r.value,"max-lines":2,"show-all-items":a.value,"onUpdate:visibleItems":s[1]||(s[1]=o=>n.value=o),"onUpdate:collapsedItems":s[2]||(s[2]=o=>r.value=o)},{visibleItems:S(()=>[(p(!0),m(I,null,B(n.value,o=>(p(),C(R,{key:`${o.title}-${i.$options.value}`,"selected-option":o,container:i.container,class:w(["mb-1 mr-1 inline-block",i.disabled&&"pointer-events-none bg-grey-5 text-grey-1"]),"onDelete:selectedOption":()=>u("delete:selectedOption",o)},null,8,["selected-option","container","class","onDelete:selectedOption"]))),128))]),collapsedMenu:S(()=>[f("div",{class:w(["cursor-pointer rounded",a.value?"text-red-2":"text-blue-2","bg-grey-5 hover:bg-grey-4","px-4 py-1",i.disabled&&"pointer-events-none bg-grey-5"]),"data-test":"CollapsedMenuForChips",onClick:s[0]||(s[0]=()=>{var o;a.value=!a.value,(o=l.value)==null||o.rerender(i.selectedOptions)})},[f("span",null,N(`${a.value?"–":"+"} ${e.value}`),1)],2)]),_:1},8,["visible-items","collapsed-items","show-all-items"]))}}),Q={key:0},X=f("li",{class:"p-2 text-grey-2"},"Выбранные",-1),Y=["onClick"],Z=f("li",{class:"px-2 py-5"},[f("div",{class:"h-px bg-blueGrey-5"})],-1),ee=f("li",{class:"p-2 text-grey-2"},"Остальные",-1),te=["onClick"],se=y({name:"MultiSelectDropDown"}),le=y({...se,props:{selectedOptions:{},selectedOptionsLocal:{},options:{},query:{}},emits:["click:option"],setup(h,{emit:O}){const t=h,u=O,a=e=>t.query===""&&k(e,t.selectedOptionsLocal)?"!text-blue-2":void 0,l=_(()=>t.options.filter(e=>!k(e,t.selectedOptions))),n=_(()=>x(t.query,l.value)),r=_(()=>x(t.query,t.selectedOptions));return(e,i)=>(p(),m("div",null,[e.selectedOptions.length?(p(),m("ul",Q,[X,(p(!0),m(I,null,B(r.value,(s,o)=>(p(),m("li",{key:o,class:"flex cursor-pointer justify-between p-2",onClick:M(()=>u("click:option",s),["prevent"])},[b(L,{text:s.title,pattern:e.query,class:w(["whitespace-normal",a(s)])},null,8,["text","pattern","class"]),b(F,{"model-value":$(k)(s,e.selectedOptionsLocal)},null,8,["model-value"])],8,Y))),128)),Z,ee])):E("",!0),f("ul",null,[(p(!0),m(I,null,B(n.value,(s,o)=>(p(),m("li",{key:o,class:"flex max-w-full cursor-pointer justify-between gap-x-2 p-2",onClick:M(()=>u("click:option",s),["prevent"])},[b(L,{text:s.title,pattern:e.query,class:w(["whitespace-normal",a(s)])},null,8,["text","pattern","class"]),b(F,{"model-value":$(k)(s,e.selectedOptionsLocal),class:"shrink-0"},null,8,["model-value"])],8,te))),128))])]))}}),oe=y({name:"MultiSelect"}),pe=y({...oe,props:{placeholder:{},size:{},label:{},disabled:{type:Boolean},minWidth:{},isNotPreventDefaultEnter:{type:Boolean},required:{type:Boolean},isLoading:{type:Boolean},isErrorLoading:{type:Boolean},isError:{type:Boolean},errorList:{},options:{},selectedOptions:{}},emits:["update:selectedOptions"],setup(h,{emit:O}){const t=h,u=O,a=v(),l=v(),n=v(""),r=_(()=>e.value.length?`Выбрано: ${e.value.length}`:t.placeholder??""),e=v([...t.selectedOptions]),i=_(()=>x(n.value,t.options).length===0),s=c=>{const d=z(c,e.value);d===-1?e.value.push(c):e.value=T(e.value,d)},o=c=>{s(c),D(e.value)},D=c=>{const d=t.options.filter(g=>k(g,c));u("update:selectedOptions",[...d])};return q(()=>t.selectedOptions,()=>e.value=[...t.selectedOptions]),(c,d)=>(p(),m("div",{ref_key:"multiSelectContainer",ref:a},[b(A,W({ref:"baseSimpleSelect"},t,{query:n.value,"onUpdate:query":d[2]||(d[2]=g=>n.value=g),placeholder:r.value,"is-empty":i.value,"is-full-width-drop-down":""}),{default:S(()=>[b(le,{ref_key:"multiSelectDropDown",ref:l,options:c.options,"selected-options":c.selectedOptions,"selected-options-local":e.value,query:n.value,"onClick:option":d[0]||(d[0]=g=>s(g)),onVnodeUnmounted:d[1]||(d[1]=()=>D(e.value))},null,8,["options","selected-options","selected-options-local","query"])]),_:1},16,["query","placeholder","is-empty"]),c.selectedOptions.length?(p(),C(K,{key:0,"selected-options":c.selectedOptions,disabled:c.disabled,container:a.value,class:"mt-2","onDelete:selectedOption":o},null,8,["selected-options","disabled","container"])):E("",!0)],512))}});export{pe as _};
