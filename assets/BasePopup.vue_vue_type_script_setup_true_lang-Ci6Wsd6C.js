import{d as L,e as m,y as b,p as E,ae as _,o as y,c as k,D as N,h as H}from"./app-BJS3HRcf.js";const x=(t,n,a,r)=>2*(t*(Math.abs(a??0)/100))+2*(r??0)+(n?t:0),X=(t,n,a,r,f)=>{const{clientWidth:s,clientHeight:o}=document.documentElement,i=t.getBoundingClientRect(),p=n==null?void 0:n.getBoundingClientRect(),P=(p==null?void 0:p.left)??0,F=(p==null?void 0:p.right)??s,h=(p==null?void 0:p.top)??0,v=(p==null?void 0:p.bottom)??o,T=M({elementLeft:i.left,elementRight:i.right,containerLeft:P,containerRight:F,mirrorX:r,elementWidth:i.width,elementPosition:a}),c=S({elementTop:i.top,elementBottom:i.bottom,containerTop:h,containerBottom:v,mirrorY:f,elementHeight:i.height,elementPosition:a});return{originalPosition:{top:i.top,left:i.left},shiftedPosition:{top:c,left:T},container:{top:h,left:P}}},M=({elementLeft:t,elementRight:n,containerLeft:a,containerRight:r,mirrorX:f,elementWidth:s,elementPosition:o})=>t<a?f?t+x(s,o.toLeftFromPointerPx!==void 0,o.translateXPercent,o.toLeftFromPointerPx):a:n>r?f?t-x(s,o.toLeftFromPointerPx===void 0,o.translateXPercent,o.toRightFromPointerPx):t-n+r:NaN,S=({elementTop:t,elementBottom:n,containerTop:a,containerBottom:r,mirrorY:f,elementHeight:s,elementPosition:o})=>t<a?f?t+x(s,o.toTopFromPointerPx!==void 0,o.translateYPercent,o.toTopFromPointerPx):a:n>r?f?t-x(s,o.toTopFromPointerPx===void 0,o.translateYPercent,o.toBottomFromPointerPx):t-n+r:NaN,A=(t,n)=>{switch(n){case"left":return{left:t.left,top:t.bottom+t.height/2};case"right":return{left:t.right,top:t.bottom+t.height/2};case"top":return{left:t.left+t.width/2,top:t.top};case"bottom":return{left:t.left+t.width/2,top:t.bottom}}},O=L({name:"BasePopup"}),Y=L({...O,props:{toLeftFromPointerPx:{},toTopFromPointerPx:{},toRightFromPointerPx:{default:0},toBottomFromPointerPx:{default:0},translateXPercent:{},translateYPercent:{}},emits:["popup:open","popup:mouseleave"],setup(t,{expose:n,emit:a}){const r=t,f=a,s=m(!1),o=m(),i=m(0),p=m(0),P=u=>{let e;return()=>{e||s.value&&(e=setTimeout(()=>{c(),clearTimeout(e),e=void 0},u))}},F=u=>{let e;return(l=0,d=0)=>{e||s.value||(e=setTimeout(()=>{v(l,d),clearTimeout(e),e=void 0},u))}},h=(u,e)=>{var d;const l=(d=o.value)==null?void 0:d.getBoundingClientRect();return l!==void 0&&u>=l.left&&u<=l.right&&e>=l.top&&e<=l.bottom},v=(u=0,e=0)=>{i.value=u,p.value=e,s.value=!0},T=(u,e)=>{var g;const l=(g=u.target)==null?void 0:g.getBoundingClientRect(),{left:d,top:w}=A(l,e);i.value=d,p.value=w,s.value=!0},c=()=>{s.value=!1};return b(()=>o.value,()=>{var B,C;if(!o.value)return;const u=(B=o.value)==null?void 0:B.getBoundingClientRect().width,e=(C=o.value)==null?void 0:C.getBoundingClientRect().height,l=u*((r.translateXPercent??0)/100),d=e*((r.translateYPercent??0)/100),w=r.toLeftFromPointerPx!==void 0?i.value-u-r.toLeftFromPointerPx+l:i.value+r.toRightFromPointerPx+l,g=r.toTopFromPointerPx!==void 0?p.value-e-r.toTopFromPointerPx+d:p.value+r.toBottomFromPointerPx+d;o.value.style.left=`${w}px`,o.value.style.top=`${g}px`,f("popup:open")}),n({showPopup:v,showPopupElementEventHandler:T,closePopup:c,throttledOpenPopupAfter:F,throttledClosePopupAfter:P,popup:o,checkIsPointerOnPopup:h,isShown:s}),E(()=>{window.addEventListener("scroll",c)}),_(()=>{window.removeEventListener("scroll",c)}),(u,e)=>s.value?(y(),k("div",{key:0,ref_key:"popupRef",ref:o,onMouseleave:e[0]||(e[0]=()=>f("popup:mouseleave"))},[N(u.$slots,"default")],544)):H("",!0)}});export{Y as _,A as g,X as s};
