import{d as w,e as u,p as R,ae as z,o as x,c as W,b as _,D as h,h as N,n as L,f as $,w as b,O as B}from"./app-BJS3HRcf.js";function P(s){if(!s)return 0;const e=parseInt(window.getComputedStyle(s).getPropertyValue("margin-left"),10);return isNaN(e)?0:e}function O(s){if(!s)return 0;const e=parseInt(window.getComputedStyle(s).getPropertyValue("margin-right"),10);return isNaN(e)?0:e}function C(s){return s?P(s)+Math.round(s.getBoundingClientRect().width)+O(s):0}function k(s,e){return parseInt(window.getComputedStyle(s).getPropertyValue(e),10)}function A(s){return s.map(e=>({width:k(e,"margin-left")+e.getBoundingClientRect().width+k(e,"margin-right"),element:e}))}const S=(s,e,v)=>{let r=0;const i=s+v;let t=0;for(;t<e.length&&r<=s;)r+=e[t].width,t+=1;return t===e.length&&r<=i?-1:t-1},T=(s,e,v)=>{const r=(e==null?void 0:e.getVisibleMenuWidth())??0,i=(e==null?void 0:e.getCollapsedMenuWidth())??0,t=Array.from({length:s}).map((m,p)=>r-(p===s-1?i:0));let l=0,d=0,o=0;for(;o<t.length&&d!==-1;)d=S(t[o],v.slice(l),i),l+=d,o++;return d===-1?-1:l},E=w({name:"BaseFlexibleMenu"}),F=w({...E,props:{maxLines:{}},emits:["resize"],setup(s,{expose:e,emit:v}){const r=v,i=u(),t=u(),l=u(),d=u(),o=u(!1),m=u(),p=new ResizeObserver(()=>{clearTimeout(m.value),m.value=setTimeout(()=>{if(t.value){const n=C(i.value),V=C(d.value);t.value.style.maxWidth=`${n-V}px`}r("resize")},100)});R(()=>I()),z(()=>f());const M=n=>o.value=n,a=n=>{i.value&&(i.value.style.visibility=n?"visible":"hidden")},c=()=>{var n;return[...((n=t.value)==null?void 0:n.children)??[]].slice(0,o.value?-1:void 0)},g=()=>{var n;return Number((n=t.value)==null?void 0:n.style.maxWidth.slice(0,-2))},y=()=>C(l.value),f=()=>{i.value&&p.unobserve(i.value)},I=()=>{i.value&&p.observe(i.value)};return e({isCollapsedMenuVisible:o,menuContainer:i,getVisibleMenuItems:c,getVisibleMenuWidth:g,getCollapsedMenuWidth:y,changeCollapsedMenuVisibility:M,changeMenuContainerVisibility:a,stopResize:f,startResize:I}),(n,V)=>(x(),W("div",{ref_key:"menuContainer",ref:i,class:"invisible relative flex items-center"},[_("nav",{ref_key:"visibleMenuRef",ref:t,class:L(["flex shrink-0 grow-0",n.maxLines>1&&"flex-wrap"])},[h(n.$slots,"visibleItems"),o.value?(x(),W("div",{key:0,ref_key:"collapsedMenuRef",ref:l,class:"shrink-0 grow-0"},[h(n.$slots,"collapsedMenu")],512)):N("",!0)],2),_("div",{ref_key:"rightBoundaryRef",ref:d,class:"absolute right-0 shrink-0 grow-0"},[h(n.$slots,"rightBoundary")],512)],512))}}),D=w({name:"FlexibleMenu"}),U=w({...D,props:{visibleItems:{},collapsedItems:{},maxLines:{default:1},showAllItems:{type:Boolean,default:!1}},emits:["update:visibleItems","update:collapsedItems"],setup(s,{expose:e,emit:v}){const r=s,i=v,t=u(),l=u(),d=u([]),o=u(!1),m=u(-1),p=()=>{var a,c,g,y,f,I,n;if(o.value||(o.value=!0,d.value=A(((a=t.value)==null?void 0:a.getVisibleMenuItems())??[]),(c=t.value)==null||c.changeMenuContainerVisibility(!0)),m.value=T(r.maxLines,t.value,d.value),m.value>-1){if(!((g=t.value)!=null&&g.isCollapsedMenuVisible)){(y=t.value)==null||y.changeCollapsedMenuVisibility(!0),B(()=>p());return}r.showAllItems||(i("update:visibleItems",((f=l.value)==null?void 0:f.slice(0,m.value))??[]),i("update:collapsedItems",((I=l.value)==null?void 0:I.slice(m.value))??[]))}else i("update:visibleItems",l.value??[]),i("update:collapsedItems",[]),(n=t.value)==null||n.changeCollapsedMenuVisibility(!1)},M=a=>{var c;(c=t.value)==null||c.stopResize(),l.value=[...a],i("update:visibleItems",a),i("update:collapsedItems",[]),o.value=!1,B(()=>setTimeout(()=>{var g;return(g=t.value)==null?void 0:g.startResize()}))};return R(()=>l.value=[...r.visibleItems]),z(()=>{i("update:visibleItems",l.value??[]),i("update:collapsedItems",[])}),e({rerender:a=>M(a),indexOfNotFitItem:m}),(a,c)=>(x(),$(F,{ref_key:"baseFlexibleMenuRef",ref:t,"max-lines":a.maxLines,onResize:c[0]||(c[0]=()=>p())},{visibleItems:b(()=>[h(a.$slots,"visibleItems")]),collapsedMenu:b(()=>[h(a.$slots,"collapsedMenu")]),rightBoundary:b(()=>[h(a.$slots,"rightBoundary")]),_:3},8,["max-lines"]))}});export{U as _};
